name: Deploy - Prod
run-name: Deploy Version ${{ github.ref_name }}

on:
  workflow_dispatch:
    inputs:
      environment:
        type: choice
        description: Selecione o ambiente para deploy
        options: 
        - develop
        - alpha1

jobs:        
  develop:
    if: github.event.inputs.environment == 'develop'
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash
        working-directory: ./src
    steps:
      - uses: actions/checkout@v3
        with:
           fetch-depth: 0
        name: Checkout
        
  alpha1:
    if: github.event.inputs.environment == 'alpha1'
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash
        working-directory: ./src
    steps:
      - uses: actions/checkout@v3
        with:
           fetch-depth: 0
        name: Checkout
        
        
  notify:
        name: Send Discord Notification
        runs-on: ubuntu-latest
        needs:
          - develop
          - alpha1
        if: ${{ always() }}

        steps:        
          - name: Notify Deploy Develop
            uses: nobrayner/discord-webhook@v1
            with:
              github-token: ${{ secrets.GITHUB_TOKEN }}
              discord-webhook: ${{ secrets.WEBHOOK_DISCORD }}
              color-success: '#30FA25'
              color-failure: '#EB4034'
              color-cancelled: '#808080'
    
    
    
